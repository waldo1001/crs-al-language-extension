{
    "Snippet: PageWizard": {
        "description": "Snippet (waldo): Wizard Page (3 steps)",
        "prefix": "tpagewizard3stepswaldo",
        "body": [
            "page ${1:Id} \"${2:PageName} Wizard\"",
            "{",
            "\tCaption = '${2:PageName}';",
            "\tPageType = NavigatePage;",
            "\tSourceTable = ${3:\"TableName\"};",
            "\tSourceTableTemporary = true;",
            "",
            "\tlayout",
            "\t{",
            "\t\tarea(Content)",
            "\t\t{",
            "\t\t\tgroup(StandardBanner)",
            "\t\t\t{",
            "\t\t\t\tShowCaption = false;",
            "\t\t\t\tEditable = false;",
            "\t\t\t\tVisible = TopBannerVisible and not FinishActionEnabled;",
            "\t\t\t\tfield(MediaResourcesStandard; MediaResourcesStandard.\"Media Reference\")",
            "\t\t\t\t{",
            "\t\t\t\t\tApplicationArea = All;",
            "\t\t\t\t\tEditable = false;",
            "\t\t\t\t\tShowCaption = false;",
            "\t\t\t\t}",
            "\t\t\t}",
            "\t\t\tgroup(FinishedBanner)",
            "\t\t\t{",
            "\t\t\t\tShowCaption = false;",
            "\t\t\t\tEditable = false;",
            "\t\t\t\tVisible = TopBannerVisible and FinishActionEnabled;",
            "\t\t\t\tfield(MediaResourcesDone; MediaResourcesDone.\"Media Reference\")",
            "\t\t\t\t{",
            "\t\t\t\t\tApplicationArea = All;",
            "\t\t\t\t\tEditable = false;",
            "\t\t\t\t\tShowCaption = false;",
            "\t\t\t\t}",
            "\t\t\t}",
            "",
            "\t\t\tgroup(Step1)",
            "\t\t\t{",
            "\t\t\t\tShowCaption = false;",
            "\t\t\t\tVisible = Step1Visible;",
            "\t\t\t\tgroup(\"Welcome to ${2:PageName}\")",
            "\t\t\t\t{",
            "\t\t\t\t\tCaption = 'Welcome to ${2:PageName} Setup';",
            "\t\t\t\t\tVisible = Step1Visible;",
            "\t\t\t\t\tgroup(Group18)",
            "\t\t\t\t\t{",
            "\t\t\t\t\t\tShowCaption = false;",
            "\t\t\t\t\t\tInstructionalText = 'Step1 - Replace this text with some instructions.';",
            "\t\t\t\t\t}",
            "\t\t\t\t}",
            "\t\t\t\tgroup(\"Let's go!\")",
            "\t\t\t\t{",
            "\t\t\t\t\tCaption = 'Let''s go!';",
            "\t\t\t\t\tgroup(Group22)",
            "\t\t\t\t\t{",
            "\t\t\t\t\t\tShowCaption = false;",
            "\t\t\t\t\t\tInstructionalText = 'Step1 - Replace this text with some more instructions.';",
            "\t\t\t\t\t}",
            "\t\t\t\t}",
            "\t\t\t}",
            "",
            "\t\t\tgroup(Step2)",
            "\t\t\t{",
            "\t\t\t\tShowCaption = false;",
            "\t\t\t\tInstructionalText = 'Step2 - Replace this text with some instructions.';",
            "\t\t\t\tVisible = Step2Visible;",
            "\t\t\t\t//You might want to add fields here",
            "\t\t\t}",
            "\t\t\t",
            "",
            "\t\t\tgroup(Step3)",
            "\t\t\t{",
            "\t\t\t\tShowCaption = false;",
            "\t\t\t\tVisible = Step3Visible;",
            "\t\t\t\tgroup(Group23)",
            "\t\t\t\t{",
            "\t\t\t\t\tShowCaption = false;",
            "\t\t\t\t\tInstructionalText = 'Step3 - Replace this text with some instructions.';",
            "\t\t\t\t}",
            "\t\t\t\tgroup(\"That's it!\")",
            "\t\t\t\t{",
            "\t\t\t\t\tCaption = 'That''s it!';",
            "\t\t\t\t\tgroup(Group25)",
            "\t\t\t\t\t{",
            "\t\t\t\t\t\tShowCaption = false;",
            "\t\t\t\t\t\tInstructionalText = 'To save this setup, choose Finish.';",
            "\t\t\t\t\t}",
            "\t\t\t\t}",
            "\t\t\t}",
            "\t\t}",
            "\t}",
            "\tactions",
            "\t{",
            "\t\tarea(Processing)",
            "\t\t{",
            "\t\t\taction(ActionBack)",
            "\t\t\t{",
            "\t\t\t\tApplicationArea = All;",
            "\t\t\t\tCaption = 'Back';",
            "\t\t\t\tEnabled = BackActionEnabled;",
            "\t\t\t\tImage = PreviousRecord;",
            "\t\t\t\tInFooterBar = true;",
            "\t\t\t\ttrigger OnAction()",
            "\t\t\t\tbegin",
            "\t\t\t\t\tNextStep(true);",
            "\t\t\t\tend;",
            "\t\t\t}",
            "\t\t\taction(ActionNext)",
            "\t\t\t{",
            "\t\t\t\tApplicationArea = All;",
            "\t\t\t\tCaption = 'Next';",
            "\t\t\t\tEnabled = NextActionEnabled;",
            "\t\t\t\tImage = NextRecord;",
            "\t\t\t\tInFooterBar = true;",
            "\t\t\t\ttrigger OnAction()",
            "\t\t\t\tbegin",
            "\t\t\t\t\tNextStep(false);",
            "\t\t\t\tend;",
            "\t\t\t}      ",
            "\t\t\taction(ActionFinish)",
            "\t\t\t{",
            "\t\t\t\tApplicationArea = All;",
            "\t\t\t\tCaption='Finish';",
            "\t\t\t\tEnabled = FinishActionEnabled;",
            "\t\t\t\tImage = Approve;",
            "\t\t\t\tInFooterBar = true;",
            "\t\t\t\ttrigger OnAction()",
            "\t\t\t\tbegin",
            "\t\t\t\t\tFinishAction();",
            "\t\t\t\tend;",
            "\t\t\t}",
            "\t\t}",
            "\t}",
            "",
            "\ttrigger OnInit()",
            "\tbegin",
            "\t\tLoadTopBanners();",
            "\tend;",
            "",
            "\ttrigger OnOpenPage()",
            "\tvar",
            "\t\t${4:RecordVar}: Record ${3:TableName};",
            "\tbegin",
            "\t\tRec.Init();",
            "\t\tif ${4:RecordVar}.Get() then",
            "\t\t\tRec.TransferFields(${4:RecordVar});",
            "\t\t",
            "\t\tRec.Insert();",
            "",
            "\t\tStep := Step::Start;",
            "\t\tEnableControls();",
            "\tend;",
            "",
            "\tvar",
            "\t\tMediaRepositoryDone: Record \"Media Repository\";",
            "\t\tMediaRepositoryStandard: Record \"Media Repository\";",
            "\t\tMediaResourcesDone: Record \"Media Resources\";",
            "\t\tMediaResourcesStandard: Record \"Media Resources\";",
            "\t\tStep: Option Start,Step2,Finish;",
            "\t\tBackActionEnabled: Boolean;",
            "\t\tFinishActionEnabled: Boolean;",
            "\t\tNextActionEnabled: Boolean;",
            "\t\tStep1Visible: Boolean;",
            "\t\tStep2Visible: Boolean;",
            "\t\tStep3Visible: Boolean;",
            "\t\tTopBannerVisible: Boolean;",
            "",
            "\tlocal procedure EnableControls()",
            "\tbegin",
            "\t\tResetControls();",
            "",
            "\t\tcase Step of",
            "\t\t\tStep::Start:",
            "\t\t\t\tShowStep1();",
            "\t\t\tStep::Step2:",
            "\t\t\t\tShowStep2();",
            "\t\t\tStep::Finish:",
            "\t\t\t\tShowStep3();",
            "\t\tend;",
            "\tend;",
            "",
            "\tlocal procedure Store${4:RecordVar}()",
            "\tvar",
            "\t\t${4:RecordVar}: Record ${3:TableName};",
            "\tbegin",
            "\t\tif not ${4:RecordVar}.Get() then begin",
            "\t\t\t${4:RecordVar}.Init();",
            "\t\t\t${4:RecordVar}.Insert();",
            "\t\tend;",
            "",
            "\t\t${4:RecordVar}.TransferFields(Rec, false);",
            "\t\t${4:RecordVar}.Modify(true);",
            "\tend;",
            "",
            "",
            "\tlocal procedure FinishAction()",
            "\tbegin",
            "\t\tStore${4:RecordVar}();",
            "\t\tCurrPage.Close();",
            "\tend;",
            "",
            "\tlocal procedure NextStep(Backwards: Boolean)",
            "\tbegin",
            "\t\tif Backwards then",
            "\t\t\tStep := Step - 1",
            "\t\telse",
            "\t\t\tStep := Step + 1;",
            "",
            "\t\tEnableControls();",
            "\tend;",
            "",
            "\tlocal procedure ShowStep1()",
            "\tbegin",
            "\t\tStep1Visible := true;",
            "",
            "\t\tFinishActionEnabled := false;",
            "\t\tBackActionEnabled := false;",
            "\tend;",
            "",
            "\tlocal procedure ShowStep2()",
            "\tbegin",
            "\t\tStep2Visible := true;",
            "\tend;",
            "",
            "\tlocal procedure ShowStep3()",
            "\tbegin",
            "\t\tStep3Visible := true;",
            "",
            "\t\tNextActionEnabled := false;",
            "\t\tFinishActionEnabled := true;",
            "\tend;",
            "",
            "\tlocal procedure ResetControls()",
            "\tbegin",
            "\t\tFinishActionEnabled := false;",
            "\t\tBackActionEnabled := true;",
            "\t\tNextActionEnabled := true;",
            "",
            "\t\tStep1Visible := false;",
            "\t\tStep2Visible := false;",
            "\t\tStep3Visible := false;",
            "\tend;",
            "",
            "\tlocal procedure LoadTopBanners()",
            "\tbegin",
            "\t\tif MediaRepositoryStandard.Get('AssistedSetup-NoText-400px.png', Format(CurrentClientType())) and",
            "\t\t\tMediaRepositoryDone.Get('AssistedSetupDone-NoText-400px.png', Format(CurrentClientType()))",
            "\t\tthen",
            "\t\t\tif MediaResourcesStandard.Get(MediaRepositoryStandard.\"Media Resources Ref\") and",
            "\t\t\t\tMediaResourcesDone.Get(MediaRepositoryDone.\"Media Resources Ref\")",
            "\t\tthen",
            "\t\t\t\tTopBannerVisible := MediaResourcesDone.\"Media Reference\".HasValue();",
            "\tend;",
            "}"
        ]
    }
}